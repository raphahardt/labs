<!DOCTYPE html>
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://twitter.github.io/typeahead.js/css/examples.css">
        <link rel="stylesheet" href="//cdn.datatables.net/1.10.0/css/jquery.dataTables.css">
    </head>
    <body>

        <div ng-app="teste" ng-controller="TesteCtrl" style="padding: 50px;">

            <script id="teste/teste.html" type="text/ng-template">
                <div>
                    <strong>{{ name }} - {{ $index }}</strong>
                </div>
            </script>

            <div datatable="optionsDt" ng-init="col1 = 'name'; col2 = 'position'">

                <!--<p>Procurar: <input type="search" data-datatable-search data-for="'nomecoluna'" ng-model="dt_busca" /></p>-->
                <p>Procurar: <input type="search" datatable-search ng-model="dt_busca" /></p>

                <p>Por página:
                    <input type="number" ng-model="dt_tamanho"/>
                    <select datatable-length ng-model="dt_tamanho">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option value="200">200</option>
                    </select>
                </p>

                <div datatable-pagination in="pages" watch="dt_page">
                    Página:
                    <div>
                        <span ng-repeat="page in pages track by page.index">
                            <button type="button" ng-click="setPage(page.index)" class="btn btn-default" ng-class="{ active: page.active }">
                                {{ page.number }}</button>
                        </span>
                    </div>
                </div>

                <div datatable-info in="dt_info">
                    Mostrando {{ dt_info.start }} até {{ dt_info.end }} de {{ dt_info.displayed }}
                    <span ng-show="dt_info.total != dt_info.displayed">(filtrado de {{dt_info.total}})</span>
                </div>

                <div>
                    <input ng-model="col1" ng-model-options="{updateOn:'blur'}"/>
                    <input ng-model="col2" ng-model-options="{updateOn:'blur'}"/>
                    <input type='checkbox' ng-model='col3v' />
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>Coluna 0</th>
                            <th datatable-column name="{{col1}}"
                                template="teste/teste.html"
                                visible="{{col3v}}">Coluna 1
                                <input type="search" datatable-search ng-model="dt_busca_col" />
                            </th>
                            <th data-datatable-column name="{{col2}}"
                                visible="true">Coluna 2</th>
                            <th datatable-column="x" name="salary"
                                visible="{{col3v}}">Coluna 3</th>
                            <th>Coluna 4</th>
                        </tr>
                    </thead>
                </table>

            </div>

            <pre>
Escolhidos: b:{{ dt_busca }}, t:{{ dt_tamanho }}
            </pre>

            <button class="btn btn-default" data-tooltip="conteudo" data-placement="right">teste</button>

            <input type="text" ng-model="conteudo.title"/>

            <span ng-show="carregando">Carregando...</span>
            <input type="text" data-typeahead="options" data-model="teste" />

            <p>Hint? <input type="checkbox" ng-model="options.options.hint"/></p>
            <p>highlight? <input type="checkbox" ng-model="options.options.highlight"/></p>
            <p>minLength? <input type="number" ng-model="options.options.minLength"/></p>

            <div><h3>local</h3>
                <ul>
                    <li ng-repeat="num in local"><input ng-model="num.num"><button type="button" ng-click="remove($index)">rem</button></li>
                    <li><input ng-model="newNum"><button type="button" ng-click="adiciona(newNum); newNum = ''">add</button></li>
                </ul>
            </div>

            <pre>
{{ options | json }}

{{ teste |json }}

{{ status }}</pre>

            <input type='number' ng-model='timeout'/>
            <div data-brd-show-away='timeout'>Estou away!</div>

        </div>

        <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="http://twitter.github.io/typeahead.js/releases/latest/typeahead.bundle.js"></script>
        <!--<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.js"></script>-->
        <script src="//cdn.datatables.net/1.10.0/js/jquery.dataTables.js"></script>
        <script src="http://code.angularjs.org/1.3.0-beta.10/angular.js"></script>
        <script src="http://code.angularjs.org/1.3.0-beta.10/angular-animate.min.js"></script>
        <script src="src/js/broda-awaydetector.js"></script>
        <script src="src/js/broda-typeahead.js"></script>
        <script src="src/js/broda-datatable.js"></script>
        <script>

            function $typeaheadObject () {}

            angular.module('teste', ['broda.typeahead', 'broda.datatable'])
                .controller('TesteCtrl', [
                        '$scope',
                        function ($scope) {

                            $scope.optionsDt = {};

                            $scope.setPage = function(i) {
                                $scope.dt_page = i;
                            };

                            $scope.conteudo = {};
                            $scope.conteudo.title = 'aaa';

                            $scope.teste = '';

                            $scope.local = [
                                {num: 'one'},
                                {num: 'two'},
                                {num: 'three'},
                                {num: 'four'}
                            ];

                            $scope.adiciona = function (val) {
                                $scope.local.push({num: val});
                            };

                            $scope.remove = function (i) {
                                $scope.local.splice(i, 1);
                            };

                            $scope.carregando = false;

                            $scope.options = {
                                options: {
                                    highlight: true,
                                    hint: true,
                                    minLength: 1
                                },
                                datasets: [
                                    {
                                        name: 'numeros',
                                        displayKey: 'num',
                                        templates: {
                                            empty: '<div>Nenhum registro encontrado para {{query}}</div>',
                                            footer: '<div>Pesquisa para {{query}}<span ng-show="isEmpty"> - mais resultados</span></div>',
                                            header: '<h3>Numeros (com {{query}})</h3>',
                                            suggestion: '<p>Número {{num}}</p>'
                                        },
                                        source: {
                                            datumTokenizer: function (datum) {
                                                return datum.num.split(/\s+/);
                                            },
                                            queryTokenizer: function (query) {
                                                return query.split(/\s+/);
                                            },
                                            limit: 10,
                                            //dupDetector: function (r, l) {},
                                            //sorter: function (v1,v2) {},
                                            local: $scope.local,
                                            prefetch: 'prefetch',
                                            remote: {
                                                url: 'remote/%QUERY',
                                                ajax: {
                                                    beforeSend: function () {
                                                        $scope.carregando = true;
                                                    },
                                                    complete: function () {
                                                        $scope.carregando = false;
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        name: 'letras',
                                        displayKey: 'letter',
                                        templates: {
                                            empty: '<div>Nenhuma letra encontrada para {{query}}</div>',
                                            footer: '<div>Pesquisa de letra para {{query}}<span ng-show="isEmpty"> - mais resultados</span></div>',
                                            header: '<h3>Letras (com {{query}})</h3>',
                                            suggestion: '<p>Letra {{letter}}</p>'
                                        },
                                        source: {
                                            datumTokenizer: function (datum) {
                                                return datum.letter.split(/\s+/);
                                            },
                                            queryTokenizer: function (query) {
                                                return query.split(/\s+/);
                                            },
                                            limit: 5,
                                            //dupDetector: function (r, l) {},
                                            //sorter: function (v1,v2) {},
                                            local: [
                                                {letter: 'ei'},
                                                {letter: 'bee'},
                                                {letter: 'see'},
                                                {letter: 'dee'},
                                                {letter: 'e'},
                                                {letter: 'ef'},
                                                {letter: 'gee'},
                                                {letter: 'eich'}
                                            ]
                                        }
                                    }
                                ]
                            };
                        }
                    ]);

            angular.module('teste2', ['broda.awayDetector'])

                    .directive('tooltip', [
                        function () {
                            return {
                                restrict: 'A',
                                scope: {
                                    tooltip: '='
                                },
                                link: function postLink($scope, $element, $attrs) {
                                    $element.tooltip({
                                        title: function () {
                                            return $scope.tooltip.title || '';
                                        }
                                    });
                                }
                            };
                        }
                    ])
                    .controller('TesteCtrl', [
                        '$scope', '$awaylistener',
                        function ($scope, $idle) {
                            $scope.conteudo = {};
                            $scope.conteudo.title = 'aaa';

                            $scope.teste = '';

                            $scope.status = ['online'];

                            $scope.timeout = 2000;

                            $idle.listen().on('active', function () {
                                $scope.status.push('back!');
                            }).on('away', function () {
                                $scope.status.push('away...');
                            }).on('idle', function () {
                                $scope.status.push('idle......');
                            });

                            $scope.options = {
                                options: {
                                    highlight: true,
                                    hint: true,
                                    minLength: 1
                                },
                                datasets: //[
                                    {
                                        name: 'numeros',
                                        displayKey: 'num',
                                        templates: {
                                            empty: '<div>Nenhum registro encontrado para {{query}}</div>',
                                            footer: '<div>Pesquisa para {{query}}<span ng-show="isEmpty"> - mais resultados</span></div>',
                                            header: '<h3>Numeros (com {{query}})</h3>',
                                            suggestion: '<p>Número {{num}}</p>'
                                        },
                                        source: {
                                            datumTokenizer: function (datum) {
                                                return datum.num.split(/\s+/);
                                            },
                                            queryTokenizer: function (query) {
                                                return query.split(/\s+/);
                                            },
                                            limit: 10,
                                            //dupDetector: function (r, l) {},
                                            //sorter: function (v1,v2) {},
                                            local: [
                                                {num: 'one'},
                                                {num: 'two'},
                                                {num: 'three'},
                                                {num: 'four'}
                                            ],
                                            prefetch: 'prefetch',
                                            remote: 'remote/%QUERY'
                                        }
                                    }
                                //]
                            };
                        }
                    ]);

        </script>
    </body>
</html>
